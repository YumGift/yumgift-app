<!-- POPUP MODAL (agregar justo antes del cierre de </body>) -->
<div id="popup" style="display:none; position: fixed; top:0; left:0; right:0; bottom:0; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 999;">
  <div style="background:white; padding:20px; border-radius:12px; max-width:400px; width:90%; text-align:left;">
    <h2 style="margin-top:0; color:#ff4c8b;">Detalle de tu pedido</h2>
    <div id="popupProductos"></div>
    <p class="total" style="font-size:18px; font-weight:bold; color:#ff4c8b;">Total: $<span id="popupTotal"></span></p>
    <button id="confirmPedido" style="margin-top:10px; background:#25D366; color:white; padding:10px 15px; border:none; border-radius:6px; cursor:pointer;">Confirmar y enviar a WhatsApp</button>
    <button id="cerrarPopup" style="margin-top:10px; background:#ff4c8b; color:white; padding:10px 15px; border:none; border-radius:6px; cursor:pointer;">Cancelar</button>
  </div>
</div>

<script>
// Mostrar popup al hacer clic en el carrito
document.getElementById('carritoBtn').addEventListener('click', ()=>{
  const carrito = JSON.parse(localStorage.getItem("carritoYumgifts")) || [];
  if(carrito.length===0){ alert("Agregá productos primero"); return; }

  // Generar HTML de productos
  let html = carrito.map(i=>`<p>${i.nombre}: ${i.cantidad}</p>`).join('');
  document.getElementById('popupProductos').innerHTML = html;
  document.getElementById('popupTotal').innerText = carrito.reduce((s,i)=>s+i.precio*i.cantidad,0);

  // Mostrar popup
  document.getElementById('popup').style.display = 'flex';
});

// Cerrar popup
document.getElementById('cerrarPopup').addEventListener('click', ()=>{
  document.getElementById('popup').style.display = 'none';
});

// Confirmar pedido y enviar a WhatsApp
document.getElementById('confirmPedido').addEventListener('click', ()=>{
  const carrito = JSON.parse(localStorage.getItem("carritoYumgifts")) || [];
  let total = carrito.reduce((s,i)=>s+i.precio*i.cantidad,0);
  let productos = carrito.map(i=>`${i.nombre}: ${i.cantidad}`).join("\n");

  let mensaje = `¡Hola Yumgiftsba! Te paso mi pedido:\n\n${productos}\n\nTOTAL: $${total}`;
  window.open(`https://wa.me/5491135936372?text=${encodeURIComponent(mensaje)}`,'_blank');

  document.getElementById('popup').style.display = 'none';
});
</script>
